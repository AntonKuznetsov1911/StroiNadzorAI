"""
–ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—è
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è" –í.–°. –ê–ª–µ–∫—Å–µ–µ–≤–∞
"""

import os
import re
from pathlib import Path

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
BUILDER_REFERENCE_PATH = Path(__file__).parent / "builder_reference.txt"

def load_builder_reference():
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è

    Returns:
        str: –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∏–ª–∏ None –ø—Ä–∏ –æ—à–∏–±–∫–µ
    """
    try:
        if not BUILDER_REFERENCE_PATH.exists():
            return None

        with open(BUILDER_REFERENCE_PATH, 'r', encoding='utf-8') as f:
            content = f.read()

        return content
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞: {e}")
        return None

def search_builder_reference(query, max_results=5):
    """
    –ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è

    Args:
        query (str): –ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
        max_results (int): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

    Returns:
        list: –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Ç–µ–∫—Å—Ç–∞
    """
    content = load_builder_reference()
    if not content:
        return []

    # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã
    paragraphs = content.split('\n')

    # –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
    keywords = query.lower().split()
    results = []

    for i, paragraph in enumerate(paragraphs):
        para_lower = paragraph.lower()

        # –ü–æ–¥—Å—á–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        matches = sum(1 for keyword in keywords if keyword in para_lower)

        if matches > 0:
            # –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ç–µ–∫—É—â–∏–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ + —Å–æ—Å–µ–¥–Ω–∏–µ)
            start = max(0, i - 2)
            end = min(len(paragraphs), i + 3)
            context = '\n'.join(paragraphs[start:end])

            results.append({
                'text': context.strip(),
                'relevance': matches,
                'position': i
            })

    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
    results.sort(key=lambda x: x['relevance'], reverse=True)

    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    return results[:max_results]

def get_builder_skills_context():
    """
    –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ –Ω–∞–≤—ã–∫–∞—Ö –∏ –∑–Ω–∞–Ω–∏—è—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ–º–ø—Ç

    Returns:
        str: –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤ –∏ –∑–Ω–∞–Ω–∏–π –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
    """
    return """
üìö –°–ü–†–ê–í–û–ß–ù–ò–ö –°–¢–†–û–ò–¢–ï–õ–Ø (–í.–°. –ê–ª–µ–∫—Å–µ–µ–≤):

–ü—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏–∑ "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è":

üîß –û–°–ù–û–í–ù–´–ï –ù–ê–í–´–ö–ò –°–¢–†–û–ò–¢–ï–õ–Ø:
‚Ä¢ –£–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (–º–æ–ª–æ—Ç–æ–∫, –æ—Ç–≤–µ—Ä—Ç–∫–∞, —É—Ä–æ–≤–µ–Ω—å, —Ä—É–ª–µ—Ç–∫–∞, –ø–∏–ª–∞, –¥—Ä–µ–ª—å)
‚Ä¢ –ó–Ω–∞–Ω–∏–µ –æ—Å–Ω–æ–≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ —Ñ–∏–∑–∏–∫–∏ –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
‚Ä¢ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

üèóÔ∏è –í–ò–î–´ –†–ê–ë–û–¢:
‚Ä¢ –ó–µ–º–ª—è–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (—Ä–∞–∑–º–µ—Ç–∫–∞, –∫–æ–ø–∫–∞ —Ç—Ä–∞–Ω—à–µ–π, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è)
‚Ä¢ –ö–∞–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (–∫–ª–∞–¥–∫–∞ –∫–∏—Ä–ø–∏—á–∞, –∫–∞–º–Ω—è, –±–ª–æ–∫–æ–≤)
‚Ä¢ –®—Ç—É–∫–∞—Ç—É—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç–µ–Ω, –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ —Ä–∞—Å—Ç–≤–æ—Ä–æ–≤)
‚Ä¢ –†–∞–±–æ—Ç—ã –ø–æ –¥–µ—Ä–µ–≤—É (–ø–∏–ª–µ–Ω–∏–µ, —Å—Ç—Ä–æ–≥–∞–Ω–∏–µ, —Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π)
‚Ä¢ –ú–∞–ª—è—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π, –æ–∫—Ä–∞—Å–∫–∞)
‚Ä¢ –ö—Ä–æ–≤–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (–º–æ–Ω—Ç–∞–∂ –∫—Ä—ã—à–∏, –≥–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è)

üè† –¢–ò–ü–´ –ö–û–ù–°–¢–†–£–ö–¶–ò–ô:
‚Ä¢ –§—É–Ω–¥–∞–º–µ–Ω—Ç—ã (–ª–µ–Ω—Ç–æ—á–Ω—ã–µ, —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ, —Å–≤–∞–π–Ω—ã–µ)
‚Ä¢ –°—Ç–µ–Ω—ã (–∫–∞–º–µ–Ω–Ω—ã–µ, –∫–∏—Ä–ø–∏—á–Ω—ã–µ, –¥–µ—Ä–µ–≤—è–Ω–Ω—ã–µ, –±–µ—Ç–æ–Ω–Ω—ã–µ)
‚Ä¢ –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏—è (–¥–µ—Ä–µ–≤—è–Ω–Ω—ã–µ, –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ)
‚Ä¢ –ö—Ä–æ–≤–ª—è (—Å–∫–∞—Ç–Ω–∞—è, –ø–ª–æ—Å–∫–∞—è, —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è)

üí° –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –ü–û–î–•–û–î:
‚Ä¢ –í—Å–µ–≥–¥–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–¥ —É—Ä–æ–≤–µ–Ω—å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚Ä¢ –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π –¥–∞–≤–∞–π—Ç–µ –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚Ä¢ –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞—Ö –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª—è—Ö
‚Ä¢ –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
‚Ä¢ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–π—Ç–µ –æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö –∏ —Å–ø–æ—Å–æ–±–∞—Ö –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

üéØ –ü–†–ò–ù–¶–ò–ü–´ –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û–ì–û –°–¢–†–û–ò–¢–ï–õ–¨–°–¢–í–ê:
‚Ä¢ –ü—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
‚Ä¢ –≠–∫–æ–Ω–æ–º–Ω–æ–µ —Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
‚Ä¢ –°–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç
‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç—Ä—É–¥–∞
‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
"""

def extract_chapter_info(chapter_name):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥–ª–∞–≤–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

    Args:
        chapter_name (str): –ù–∞–∑–≤–∞–Ω–∏–µ –≥–ª–∞–≤—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–§—É–Ω–¥–∞–º–µ–Ω—Ç", "–ö—Ä–æ–≤–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã")

    Returns:
        str: –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥–ª–∞–≤—ã –∏–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
    """
    content = load_builder_reference()
    if not content:
        return ""

    # –ü–æ–∏—Å–∫ –≥–ª–∞–≤—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
    results = search_builder_reference(chapter_name, max_results=3)

    if results:
        return "\n\n".join([r['text'] for r in results])

    return ""

# –°–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Ç–µ–º–∞–º–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
BUILDER_TOPICS = {
    "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã": "–ù–∞–±–æ—Ä—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–∏–º–µ–Ω—è–µ–º—ã—Ö –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–µ",
    "–∑–µ–º–ª—è–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–ó–µ–º–ª—è–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: —Ä–∞–∑–º–µ—Ç–∫–∞, –∫–æ–ø–∫–∞, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è",
    "–∫–∞–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–ö–∞–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: –∫–ª–∞–¥–∫–∞ –∫–∏—Ä–ø–∏—á–∞, –∫–∞–º–Ω—è, –±–ª–æ–∫–æ–≤",
    "—à—Ç—É–∫–∞—Ç—É—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–®—Ç—É–∫–∞—Ç—É—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å—Ç–µ–Ω, —Ä–∞—Å—Ç–≤–æ—Ä—ã",
    "—Ä–∞–±–æ—Ç—ã –ø–æ –¥–µ—Ä–µ–≤—É": "–†–∞–±–æ—Ç—ã –ø–æ –¥–µ—Ä–µ–≤—É: –ø–∏–ª–µ–Ω–∏–µ, —Å—Ç—Ä–æ–≥–∞–Ω–∏–µ, —Å–±–æ—Ä–∫–∞",
    "–º–∞–ª—è—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–ú–∞–ª—è—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, –æ–∫—Ä–∞—Å–∫–∞",
    "–∫—Ä–æ–≤–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": "–ö—Ä–æ–≤–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã: –º–æ–Ω—Ç–∞–∂ –∫—Ä—ã—à–∏, –≥–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è",
    "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç": "–§—É–Ω–¥–∞–º–µ–Ω—Ç: –∑–∞–∫–ª–∞–¥–∫–∞, —Ç–∏–ø—ã (–ª–µ–Ω—Ç–æ—á–Ω—ã–π, —Å—Ç–æ–ª–±—á–∞—Ç—ã–π, —Å–≤–∞–π–Ω—ã–π)",
    "–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –¥–æ–º–∞, —Ä–∞–∑–º–µ—Ç–∫–∞ –∏ —á–µ—Ä—Ç–µ–∂",
    "–º–∞—Ç–µ—Ä–∏–∞–ª—ã": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤",
}

def get_topic_info(topic_key):
    """
    –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–ª—é—á–µ–≤–æ–π —Ç–µ–º–µ

    Args:
        topic_key (str): –ö–ª—é—á —Ç–µ–º—ã –∏–∑ BUILDER_TOPICS

    Returns:
        str: –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–º—ã
    """
    return BUILDER_TOPICS.get(topic_key.lower(), "")

def is_builder_question(question):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤–æ–ø—Ä–æ—Å —Å–≤—è–∑–∞–Ω–Ω—ã–º —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞

    Args:
        question (str): –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    Returns:
        bool: True –µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å —Å–≤—è–∑–∞–Ω —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º
    """
    builder_keywords = [
        '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç', '–º–æ–ª–æ—Ç–æ–∫', '–ø–∏–ª–∞', '–¥—Ä–µ–ª—å', '—É—Ä–æ–≤–µ–Ω—å',
        '–∑–µ–º–ª—è–Ω—ã–µ', '–∫–æ–ø–∞—Ç—å', '—Ç—Ä–∞–Ω—à–µ—è',
        '–∫–ª–∞–¥–∫–∞', '–∫–∏—Ä–ø–∏—á', '–∫–∞–º–µ–Ω—å', '–±–ª–æ–∫',
        '—à—Ç—É–∫–∞—Ç—É—Ä–∫–∞', '—à—Ç—É–∫–∞—Ç—É—Ä–∏—Ç—å', '—Ä–∞—Å—Ç–≤–æ—Ä',
        '–¥–µ—Ä–µ–≤–æ', '–¥–æ—Å–∫–∞', '–±—Ä—É—Å', '–ø–∏–ª–∏—Ç—å',
        '–ø–æ–∫—Ä–∞—Å–∫–∞', '–º–∞–ª—è—Ä–Ω—ã–µ', '–∫—Ä–∞—Å–∫–∞',
        '–∫—Ä–æ–≤–ª—è', '–∫—Ä—ã—à–∞', '–≥–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è',
        '—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç', '–æ—Å–Ω–æ–≤–∞–Ω–∏–µ',
        '–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞', '—á–µ—Ä—Ç–µ–∂', '—Ä–∞–∑–º–µ—Ç–∫–∞',
        '–º–∞—Ç–µ—Ä–∏–∞–ª', '—Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª',
        '–Ω–∞—á–∏–Ω–∞—é—â–∏–π —Å—Ç—Ä–æ–∏—Ç–µ–ª—å', '–∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å', '—É—á—É—Å—å —Å—Ç—Ä–æ–∏—Ç—å'
    ]

    question_lower = question.lower()
    return any(keyword in question_lower for keyword in builder_keywords)

if __name__ == "__main__":
    # –¢–µ—Å—Ç –º–æ–¥—É–ª—è
    print("=== –¢–µ—Å—Ç –º–æ–¥—É–ª—è builder_reference.py ===\n")

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
    content = load_builder_reference()
    if content:
        print(f"‚úÖ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∑–∞–≥—Ä—É–∂–µ–Ω ({len(content)} —Å–∏–º–≤–æ–ª–æ–≤)\n")
    else:
        print("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞\n")

    # –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞
    test_query = "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç"
    results = search_builder_reference(test_query)
    print(f"–ü–æ–∏—Å–∫ '{test_query}': –Ω–∞–π–¥–µ–Ω–æ {len(results)} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n")

    if results:
        print("–ü–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:")
        print(results[0]['text'][:200] + "...\n")

    # –¢–µ—Å—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è
    test_questions = [
        "–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ª–∏—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç?",
        "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ —Å–µ–≥–æ–¥–Ω—è?",
        "–ö–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω—É–∂–Ω—ã –¥–ª—è –∫–ª–∞–¥–∫–∏ –∫–∏—Ä–ø–∏—á–∞?"
    ]

    print("–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—è:")
    for q in test_questions:
        is_builder = is_builder_question(q)
        print(f"  '{q}' -> {'‚úÖ –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π' if is_builder else '‚ùå –ù–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π'}")
