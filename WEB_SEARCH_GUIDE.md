# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤–µ–±-–ø–æ–∏—Å–∫—É –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å `web_search.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–∞—Ö –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∞–π—Ç–∞—Ö –†–§.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ü–æ–∏—Å–∫ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤ –Ω–∞ docs.cntd.ru
- –ü–æ–∏—Å–∫ –ª—é–±–æ–≥–æ –°–ü, –ì–û–°–¢, –°–ù–∏–ü –ø–æ –∫–æ–¥—É
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (–¥–µ–π—Å—Ç–≤—É–µ—Ç/–æ—Ç–º–µ–Ω–µ–Ω/–∑–∞–º–µ–Ω–µ–Ω)
- –î–∞—Ç–∞ –≤–≤–µ–¥–µ–Ω–∏—è –≤ –¥–µ–π—Å—Ç–≤–∏–µ
- –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç

### 2. –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–∞ minstroyrf.gov.ru
- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –ú–∏–Ω—Å—Ç—Ä–æ—è –†–æ—Å—Å–∏–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞—Ö
- –ù–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è

–í–µ–±-–ø–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–∏:

**–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:**
- –∞–∫—Ç—É–∞–ª—å–Ω*, –Ω–æ–≤—ã–π/–Ω–æ–≤–∞—è, —Å–≤–µ–∂–∏–π, –ø–æ—Å–ª–µ–¥–Ω*
- 2025, 2026, 2027 (–≥–æ–¥–∞)
- –∏–∑–º–µ–Ω–µ–Ω–∏*, –æ–±–Ω–æ–≤–ª–µ–Ω*
- –¥–µ–π—Å—Ç–≤—É–µ—Ç, –æ—Ç–º–µ–Ω–µ–Ω
- –ø—Ä–æ–≤–µ—Ä—å, –Ω–∞–π–¥–∏, –ø–æ–∏—â–∏

**–ö–æ–¥—ã –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤:**
- –°–ü 63.13330.2018
- –ì–û–°–¢ 31937-2011
- –°–ù–∏–ü 2.01.07-85
- –ò –¥—Ä—É–≥–∏–µ

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –°–ü 63.13330.2018
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üåê –†–ï–ó–£–õ–¨–¢–ê–¢–´ –í–ï–ë-–ü–û–ò–°–ö–ê:

üìö –ü–†–û–í–ï–†–ö–ê –ù–û–†–ú–ê–¢–ò–í–û–í:

‚Ä¢ –°–ü 63.13330.2018
  –ù–∞–∑–≤–∞–Ω–∏–µ: –ë–µ—Ç–æ–Ω–Ω—ã–µ –∏ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏...
  –°—Ç–∞—Ç—É—Å: –î–µ–π—Å—Ç–≤—É–µ—Ç
  –î–µ–π—Å—Ç–≤—É–µ—Ç —Å: 15.02.2019
  –°—Å—ã–ª–∫–∞: https://docs.cntd.ru/...
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∏—Å–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤—É 2025
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üåê –†–ï–ó–£–õ–¨–¢–ê–¢–´ –í–ï–ë-–ü–û–ò–°–ö–ê:

üì∞ –ê–ö–¢–£–ê–õ–¨–ù–´–ï –ù–û–í–û–°–¢–ò –ú–ò–ù–°–¢–†–û–Ø:

‚Ä¢ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
  –î–∞—Ç–∞: 15.11.2024
  –°—Å—ã–ª–∫–∞: https://minstroyrf.gov.ru/...

‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–æ—Ä–º–∞—Ç–∏–≤—ã –ø–æ —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  –î–∞—Ç–∞: 10.11.2024
  –°—Å—ã–ª–∫–∞: https://minstroyrf.gov.ru/...
```

### –ü—Ä–∏–º–µ—Ä 3: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ø—Ä–æ–≤–µ—Ä—å –ì–û–°–¢ 31937-2011, –¥–µ–π—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω –≤ 2025?
```
–ë–æ—Ç:
1. –ò–∑–≤–ª–µ—á–µ—Ç –∫–æ–¥ "–ì–û–°–¢ 31937-2011"
2. –ù–∞–π–¥–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ docs.cntd.ru
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å
4. –ü–æ–∏—â–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ –æ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
5. –û—Ç–≤–µ—Ç–∏—Ç —Å —É—á–µ—Ç–æ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
handle_text()
    ‚Üì
classify_user_intent()  ‚Üê –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
    ‚Üì
perform_web_search()    ‚Üê –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–∏—Å–∫
    ‚Üì
    ‚îú‚îÄ should_perform_web_search() ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
    ‚îú‚îÄ extract_regulation_codes()  ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–¥–æ–≤
    ‚îú‚îÄ search_regulation_cntd()    ‚Üí –ü–æ–∏—Å–∫ –≤ –¶–ù–¢–î
    ‚îî‚îÄ search_minstroy_news()      ‚Üí –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
    ‚Üì
Claude API              ‚Üê –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

### –¢–∞–π–º–∞—É—Ç—ã –∏ retry
- –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞: 10 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–∏—Å–∫ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤–µ–±-–ø–æ–∏—Å–∫–∞
–í `bot.py` –Ω–∞–π–¥–∏—Ç–µ:
```python
WEB_SEARCH_AVAILABLE = True
```
–ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ `False` –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è.

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
–í `web_search.py` —Ñ—É–Ω–∫—Ü–∏—è `should_perform_web_search()`:
```python
search_triggers = [
    "–∞–∫—Ç—É–∞–ª—å–Ω",
    "–Ω–æ–≤—ã–π",
    # ... –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏
]
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–∞
–í `web_search.py`:
```python
response = requests.get(search_url, headers=headers, timeout=10)
#                                                           ‚Üë
#                                                   –∏–∑–º–µ–Ω–∏—Ç–µ –∑–¥–µ—Å—å
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–∞–π—Ç–æ–≤**
   - –ï—Å–ª–∏ docs.cntd.ru –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∏—Å–∫ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–æ–≤ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥

2. **–°–∫–æ—Ä–æ—Å—Ç—å**
   - –í–µ–±-–∑–∞–ø—Ä–æ—Å –∑–∞–Ω–∏–º–∞–µ—Ç 2-5 —Å–µ–∫—É–Ω–¥
   - –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ

3. **Captcha –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**
   - –°–∞–π—Ç—ã –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
   - User-Agent —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "–¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"
```
–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ docs.cntd.ru: Connection timeout
```
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç –≤ –∫–æ–¥–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### "–ù–æ—Ä–º–∞—Ç–∏–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω"
```
–ù–æ—Ä–º–∞—Ç–∏–≤ –°–ü 1.2.3 –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ docs.cntd.ru
```
**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞
- –î–æ–∫—É–º–µ–Ω—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ
- –ò–∑–º–µ–Ω–∏–ª–∞—Å—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–¥–∞
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –Ω–∞ —Å–∞–π—Ç–µ
- –û–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### "–ü–∞—Ä—Å–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
cd C:\Users\PC\StroiNadzorAI
python test_web_search.py
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
```
[INFO] üîç –ü–æ–∏—Å–∫ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞: –°–ü 63.13330.2018
[INFO] ‚úÖ –ù–∞–π–¥–µ–Ω: –ë–µ—Ç–æ–Ω–Ω—ã–µ –∏ –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–î–µ–π—Å—Ç–≤—É–µ—Ç)
[INFO] ‚úÖ –í–µ–±-–ø–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
```

–û—à–∏–±–∫–∏ —Ç–∞–∫–∂–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
```
[ERROR] –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ docs.cntd.ru: Connection timeout
[ERROR] –û—à–∏–±–∫–∞ –≤–µ–±-–ø–æ–∏—Å–∫–∞: <–æ–ø–∏—Å–∞–Ω–∏–µ>
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ë–µ–∑ –≤–µ–±-–ø–æ–∏—Å–∫–∞:**
- –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å: ~0.5 —Å–µ–∫ (Haiku)
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å: ~2 —Å–µ–∫ (Sonnet)

**–° –≤–µ–±-–ø–æ–∏—Å–∫–æ–º:**
- +2-5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –ø–æ–∏—Å–∫
- –ò—Ç–æ–≥–æ: 2.5-7 —Å–µ–∫—É–Ω–¥

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
   - Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
   - TTL: 24 —á–∞—Å–∞ –¥–ª—è –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤

2. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**
   - gostrf.com
   - kodeks.ru
   - consultant.ru

3. **–£–º–Ω—ã–π –ø–æ–∏—Å–∫**
   - –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤
   - –ê–Ω–∞–ª–∏–∑ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞—Ö
   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `bot.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç: `python test_web_search.py`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∞–π—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é
4. –°–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-12-02
**–ê–≤—Ç–æ—Ä:** Claude Code
